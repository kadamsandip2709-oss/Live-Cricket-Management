{% extends "base.html" %}

{% block title %}Home - Live Cricket Score{% endblock %}

{% block body %}
<div class="row g-4">
  <!-- Team Creation Form -->
  <div class="col-md-5">
    <div class="card shadow-lg border-0 rounded-4 p-4">
      <h4 class="mb-3 text-success fw-bold">➕ Create a Team</h4>
      <form method="POST" class="needs-validation" novalidate>
        {% csrf_token %}

        {% if team_form.non_field_errors %}
          <div class="alert alert-danger">{{ team_form.non_field_errors }}</div>
        {% endif %}

        {% for field in team_form %}
          <div class="mb-3">
            <label class="form-label fw-semibold">{{ field.label }}</label>
            {{ field }}
            {% if field.errors %}
              <div class="text-danger small">{{ field.errors|striptags }}</div>
            {% endif %}
          </div>
        {% endfor %}

        <button type="submit" class="btn btn-success w-100 fw-bold">✅ Create Team</button>
      </form>
    </div>
  </div>

  <!-- Teams List -->
  <div class="col-md-7">
    <h4 class="mb-3 text-primary fw-bold">🏏 Teams Created</h4>

    {% for team in teams %}
    <div class="card mb-4 shadow-sm border-0 rounded-4">
      <div class="card-body">
        <!-- Team header -->
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h5 class="mb-0 fw-bold text-dark">{{ team.name }}</h5>
          <div>
            <a href="{% url 'edit_team' team.id %}" class="btn btn-sm btn-outline-warning me-1">✏️ Edit</a>
            <a href="{% url 'delete_team' team.id %}" class="btn btn-sm btn-outline-danger"
               onclick="return confirm('Are you sure you want to delete this team?');">🗑 Delete</a>
          </div>
        </div>

        <!-- Team stats -->
        <p class="text-muted small mb-3">
          👥 Players: <strong>{{ team.players.count }}</strong> / {{ team.total_players }} |
          ⏱ Overs: <strong>{{ team.overs }}</strong> |
          ❌ Wickets: <strong>{{ team.wickets }}</strong>
        </p>

        <!-- Add Player -->
        <a href="{% url 'add_player' team.id %}" class="btn btn-sm btn-success mb-3">➕ Add Player</a>

        <!-- Players list -->
        <ul class="list-group list-group-flush">
          {% for player in team.players.all %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <span>
              {{ player.number }} - <strong>{{ player.name }}</strong> ({{ player.player_type|title }})
            </span>
            <span>
              <a href="{% url 'edit_player' player.id %}" class="btn btn-sm btn-outline-primary me-1">✏️ Edit</a>
              <a href="{% url 'delete_player' player.id %}" class="btn btn-sm btn-outline-danger"
                 onclick="return confirm('Delete this player?');">🗑 Delete</a>
            </span>
          </li>
          {% empty %}
          <li class="list-group-item text-muted">No players yet.</li>
          {% endfor %}
        </ul>
      </div>
    </div>
    {% empty %}
      <p class="text-muted fst-italic">No teams created yet.</p>
    {% endfor %}
  </div>
</div>
{% endblock %}
